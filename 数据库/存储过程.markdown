---
date: 2016-09-22 16:44
status: draft
title: 存储过程
---

# 存储过程
## 【1】什么是过程？过程与函数的区别？什么是存储过程？？？
	函数是带返回值的过程
	过程是没有返回值的函数
	存储过程：存储在数据库中的   封装了若干条SQL语句的过程（MySql不支持不存储的，匿名过程）

## 【2】存储过程的创建语法
```SQL
create procedure procedureName()
	begin
		-- SQL语句体（此次是和前面的触发器的begin  end中的SQL语句体类似，可以赋值，可以判断，可以定义变量）
	end;
```
## 查看所有的procedure ：
` show procedure status; `
## 【可给存储过程传递参数】
```SQL
create procedure procedureName([in/out/inout] 参数名 参数类型.....)
						其中的in/out/inout 是可选的，也就是说可有可无
		in  默认缺省是in类型，为了函数内部使用的，调用时传值 call proName(参数值)
		out 外输出参数，函数处理后，外部可调用(select @参数名)调用：call proName(@参数名)
```
> inout 兼顾二者的特点

## 【注意】：函数调用时，
		in类型给传值，call proName(参数值)
		out类型给传变量名（函数内部手动初始化）call proName(@参数名)
		inout类型 	需要传一个已经定义了的变量
				set @变量名:=变量初始值;
				call proName（@变量名）		
如：
```SQL
	create procedure p1(width int,height int)
	begin
			select width
			select  height;
	end;
```
# 【3】调用
` call procedureName() `

# 【4】存储过程的  编程	

     存储过程是可以编程的（  在begin 和 end 之间  ），可以有 变量，表达式，控制结构


## （1）变量：   
 - 定义：用declare来声明变量
 - 格式：
		declare  变量名 变量类型 default  默认初始值; 
			也可以给变量赋默认值  如 declare  gnum int;

 - 赋值：set 变量名=值（或表达式）； 如set gnum=gnum+old.much;
				或者		set 变量名:=值，如 set gnum:=gunm+old.num;
 - 使用：直接使用
		
## （2）表达式：  +-*/%都可以正常的使用
## （3）控制结构：  
- 1)分支机构
    
    ①if双分支
```SQL
			if search_condition then statement_list
   				[elseif search_condition then statement_list] ...
   				[else statement_list]
			end if;
```
   ②case多分支
    
```SQL	
			case 变量
				when 常量 then 表达式;
				when 常量 then 表达式;
				when 常量 then 表达式;
			    else 表达式(都未中 相当于default);
			end case;
```
---
 - 2)循环结构
```SQL	
			①while循环
				while search_condition DO
				    ...
    				statement_list
  				end while;
			②repeat循环（相当于 do while）
				repeat  statement_list
					until search_condition
				end repeat;	
```